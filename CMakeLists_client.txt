# Проверка версии CMake.
cmake_minimum_required(VERSION 3.00)

# Имя проекта
project(client VERSION 1.0)

# ------ Определяем ОС (Кроссплатформенность ЖЭС) ------
set(IS_WINDOWS 0)
set(IS_UNIX 0)

if ((WIN32) OR (MSYS) OR (MINGW) OR (CYGWIN))
	set(IS_WINDOWS 1)
endif ((WIN32) OR (MSYS) OR (MINGW) OR (CYGWIN))

if (UNIX)
	set(IS_UNIX 1)
endif (UNIX)

# -----------Продолжим настройку проекта------------

# Установка
set(SOURCE_EXE main_client.cpp)

# Объявляем header и source
set(HEADER client.hpp)
set(SOURCE_LIB client.cpp)

# Создаем статическую библиотеку с именем client_lib
add_library(client_lib STATIC $(SOURCE_LIB))

# Создаем исполняемый файл
add_executable(client client.cpp)

# -------Линкуем библиотеки в зависимости от ОС--------

# Линкуем библиотеки для Windows
if (IS_WINDOWS)
	set(WIN32_SOCKET_LIB wsock32)
	set(WIN32_SOCKET_LIB_2 ws2_32)
	add_library(ext_wsock32_lib SHARED $(WIN32_SOCKET_LIB))
	add_library(ext_ws2_32_lib SHARED $(WIN32_SOCKET_LIB_2))
	
	# Линкуем программу с библиотекой
	target_link_libraries(client client_lib ext_wsock32_lib ext_ws2_32_lib)
endif (IS_WINDOWS)

# Линкуем библиотеки для UNIX-like
if (UNIX)
	add_executable(client client.cpp)
	target_link_libraries(client client_lib)
endif(UNIX)
